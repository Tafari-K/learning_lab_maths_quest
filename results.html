<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Results ‚Äì Math Quest</title>
  <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
  <h1>üéâ You Completed the Challenge!</h1>

  <!-- Results from localStorage -->
  <div id="results-list"></div>

  <!-- Submission Form -->
  <h2>Share Your Achievement</h2>
    <form id="share-form" action="https://formdump.codeinstitute.net" method="POST">
      <input type="text" name="player-name" id="player-name" placeholder="Enter your name" required />
      <input type="hidden" name="game-summary" id="game-summary" />
      <button type="submit">Submit Score</button>
    </form>

<!-- ‚úÖ Button shown after form is submitted -->
  <div id="next-section-wrap" style="display: none; margin-top: 20px;">
    <button onclick="location.href='menu-page.html'">‚û°Ô∏è Continue to Next Challenge</button>
  </div>


    
  <script>
    const resultsContainer = document.getElementById("results-list");
const stored = localStorage.getItem("mathQuestResults");
const totalScore = localStorage.getItem("totalScore");
const totalQuestions = localStorage.getItem("totalQuestions");

if (stored) {
  const results = JSON.parse(stored);
  const correctAnswers = results.length;
  const totalThisRound = 5;

  const sectionScore = document.createElement("p");
  sectionScore.innerHTML = `<strong>You scored ${correctAnswers} out of ${totalThisRound}!</strong>`;
  sectionScore.style.fontSize = "1.2rem";
  sectionScore.style.marginBottom = "1rem";
  sectionScore.style.color = "#22c55e";

  resultsContainer.insertBefore(sectionScore, resultsContainer.firstChild);

  const list = results.map((item, i) =>
    `<p><strong>Q${i + 1}:</strong> ${item.question} ‚Üí <em>${item.answer}</em></p>`
  ).join("");
  resultsContainer.innerHTML += list;

  const summaryText = results.map((item, i) =>
    `Q${i + 1}: ${item.question} ‚Üí ${item.answer}`
  ).join(" | ");

  summaryInput.value = summaryText;
}


    // ‚úÖ Intercept the form and send via fetch instead of full page reload
  const form = document.getElementById("share-form");
  const nextSectionWrap = document.getElementById("next-section-wrap");

  form.addEventListener("submit", function (e) {
    e.preventDefault(); // Stop the page from reloading

    const formData = new FormData(form);

    fetch(form.action, {
      method: "POST",
      body: formData
    }).then(() => {
      // ‚úÖ After successful submission, show the next-section button
     nextSectionWrap.style.display = "block";
    const nextBtn = nextSectionWrap.querySelector("button");
    nextBtn.textContent = "‚úÖ Submitted! Continue";
    form.querySelector("button[type='submit']").disabled = true;

    }).catch(() => {
      alert("There was a problem submitting your score. Please try again.");
    });
  });

    
  </script>
</body>
</html>
